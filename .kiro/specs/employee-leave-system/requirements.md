# 需求文件

## 介紹

員工請假系統是一個多語言響應式網頁應用程式，允許員工申請請假並讓管理者管理請假記錄。系統包含前端React應用程式和Node.js後端，使用CSV檔案作為資料存儲。

## 詞彙表

- **員工請假系統**: 完整的網頁應用程式，包含前端和後端組件
- **登入頁面**: 驗證使用者身份的頁面
- **請假申請頁面**: 員工提交請假申請的主頁面
- **請假紀錄頁面**: 顯示個人請假歷史記錄的頁面
- **請假管理頁面**: 管理者審核和管理所有請假申請的頁面
- **個人資料CSV**: 包含員工基本資訊和權限的檔案
- **請假記錄CSV**: 包含所有請假申請詳細資訊的檔案
- **簽核狀態**: 請假申請的審核狀態（簽核中、已審核、已退回）
- **權限**: 使用者在系統中的角色（一般員工或管理者）
- **自動登出系統**: 監控使用者活動並在閒置超時後自動登出的系統
- **使用者活動**: 包括滑鼠移動、鍵盤輸入、點擊、觸控等使用者互動行為
- **閒置時間**: 使用者未進行任何活動的持續時間
- **超時警告**: 在自動登出前顯示的警告訊息
- **會話延長**: 使用者可以選擇延長當前會話的功能
- **強制登出**: 系統自動執行的登出操作
- **時間選擇器**: 用於選擇時間的下拉選單組件
- **時間選項**: 預定義的時間值列表，以15分鐘為間隔
- **24小時制**: 使用00:00到23:59格式的時間表示法
- **時間間隔**: 相鄰時間選項之間的時間差，設定為15分鐘

## 需求

### 需求 1

**使用者故事:** 作為員工，我想要登入系統，以便我可以存取請假功能

#### 驗收標準

1. WHEN 使用者存取任何系統頁面且未登入 THEN 員工請假系統 SHALL 顯示登入頁面要求輸入工號和密碼
2. WHEN 使用者提交登入資訊 THEN 員工請假系統 SHALL 驗證個人資料CSV檔案中的工號和密碼
3. WHEN 登入驗證成功 THEN 員工請假系統 SHALL 建立使用者會話並重導向到適當頁面
4. WHEN 登入驗證失敗 THEN 員工請假系統 SHALL 顯示錯誤訊息並保持在登入頁面

### 需求 2

**使用者故事:** 作為員工，我想要申請請假，以便我可以正式記錄我的休假需求

#### 驗收標準

1. WHEN 員工存取請假申請頁面 THEN 員工請假系統 SHALL 自動填入工號和姓名欄位並設為不可編輯
2. WHEN 員工填寫請假表單 THEN 員工請假系統 SHALL 驗證所有必填欄位已完成才啟用送出按鈕
3. WHEN 員工提交請假申請 THEN 員工請假系統 SHALL 設定申請日期時間為當前系統時間並設定簽核狀態為簽核中
4. WHEN 請假申請成功提交 THEN 員工請假系統 SHALL 將記錄儲存到請假記錄CSV並顯示完成訊息
5. WHEN 員工計算請假時數 THEN 員工請假系統 SHALL 根據開始和結束日期時間自動計算請假時數並扣除休息時間
6. WHEN 計算休息時間扣除 THEN 員工請假系統 SHALL 識別每日12:00-12:30和16:30-17:00為休息時間並從請假時數中扣除
7. WHEN 累計休息時間扣除 THEN 員工請假系統 SHALL 限制每次請假申請的休息時間扣除上限為0.5小時

### 需求 3

**使用者故事:** 作為員工，我想要查看我的請假紀錄，以便我可以追蹤我的請假歷史

#### 驗收標準

1. WHEN 員工存取請假紀錄頁面 THEN 員工請假系統 SHALL 顯示當前登入工號和篩選選項
2. WHEN 員工設定篩選條件 THEN 員工請假系統 SHALL 根據年月範圍、簽核狀態和假別篩選記錄
3. WHEN 顯示篩選結果 THEN 員工請假系統 SHALL 僅顯示該員工的請假記錄且包含指定欄位
4. WHEN 計算統計資料 THEN 員工請假系統 SHALL 依假別分類並加總請假時數
5. WHEN 篩選日期範圍 THEN 員工請假系統 SHALL 確保開始日期大於等於起始年月且結束日期小於等於結束年月

### 需求 4

**使用者故事:** 作為管理者，我想要管理所有員工的請假申請，以便我可以審核和更新請假狀態

#### 驗收標準

1. WHEN 管理者存取請假管理頁面 THEN 員工請假系統 SHALL 驗證使用者權限為管理者
2. WHEN 非管理者嘗試存取管理功能 THEN 員工請假系統 SHALL 顯示權限不足訊息並重導向到登入頁面
3. WHEN 管理者篩選請假記錄 THEN 員工請假系統 SHALL 根據工號、日期範圍、簽核狀態和假別顯示結果
4. WHEN 管理者點選單筆記錄 THEN 員工請假系統 SHALL 開啟編輯頁面顯示所有欄位供修改
5. WHEN 管理者更新記錄 THEN 員工請假系統 SHALL 設定簽核日期為當前時間和簽核者為當前登入姓名

### 需求 5

**使用者故事:** 作為管理者，我想要匯出請假資料，以便我可以進行離線分析和報告

#### 驗收標準

1. WHEN 管理者點選匯出CSV按鈕 THEN 員工請假系統 SHALL 匯出當前顯示的篩選資料
2. WHEN 產生匯出檔案 THEN 員工請假系統 SHALL 使用簽核狀態、開始年月和結束年月組成檔案名稱
3. WHEN 匯出完成 THEN 員工請假系統 SHALL 提供檔案下載功能

### 需求 6

**使用者故事:** 作為使用者，我想要使用多語言介面，以便我可以用我偏好的語言操作系統

#### 驗收標準

1. WHEN 使用者存取任何頁面 THEN 員工請假系統 SHALL 提供多語言選項
2. WHEN 使用者切換語言 THEN 員工請假系統 SHALL 更新所有介面文字為選定語言
3. WHEN 系統儲存資料 THEN 員工請假系統 SHALL 保持資料格式一致不受語言設定影響

### 需求 7

**使用者故事:** 作為系統，我需要管理CSV資料檔案，以便正確儲存和檢索請假資訊

#### 驗收標準

1. WHEN 系統讀取個人資料CSV THEN 員工請假系統 SHALL 解析工號、密碼、姓名和權限欄位
2. WHEN 系統讀取請假記錄CSV THEN 員工請假系統 SHALL 解析所有請假相關欄位包含時間戳記
3. WHEN 系統寫入CSV檔案 THEN 員工請假系統 SHALL 保持資料完整性和格式一致性
4. WHEN 處理CSV資料 THEN 員工請假系統 SHALL 正確處理特殊字元和編碼問題
5. WHEN CSV檔案損壞或遺失 THEN 員工請假系統 SHALL 提供適當的錯誤處理和恢復機制

### 需求 8

**使用者故事:** 作為系統管理員，我希望系統能在使用者閒置20分鐘後自動登出，以確保未授權人員無法存取敏感資料。

#### 驗收標準

1. WHEN 使用者登入員工專區 THEN 自動登出系統 SHALL 開始監控使用者活動
2. WHEN 使用者在20分鐘內有任何活動 THEN 自動登出系統 SHALL 重置閒置計時器
3. WHEN 使用者閒置時間達到20分鐘 THEN 自動登出系統 SHALL 執行強制登出並跳轉到登入頁面
4. WHEN 自動登出執行 THEN 自動登出系統 SHALL 顯示「你閒置已超出時間，請重新登入」訊息

### 需求 9

**使用者故事:** 作為員工，我希望在自動登出時能清楚了解登出原因，以便快速重新登入繼續工作。

#### 驗收標準

1. WHEN 自動登出觸發 THEN 自動登出系統 SHALL 顯示明確的超時訊息
2. WHEN 超時訊息顯示 THEN 自動登出系統 SHALL 提供「重新登入」按鈕
3. WHEN 使用者點擊「重新登入」 THEN 自動登出系統 SHALL 跳轉到登入頁面
4. WHEN 超時訊息顯示 THEN 自動登出系統 SHALL 在3秒後自動跳轉到登入頁面

### 需求 10

**使用者故事:** 作為開發者，我希望自動登出功能能正確處理各種使用者活動，確保系統穩定運行。

#### 驗收標準

1. WHEN 偵測到滑鼠移動事件 THEN 自動登出系統 SHALL 記錄為使用者活動
2. WHEN 偵測到鍵盤輸入事件 THEN 自動登出系統 SHALL 記錄為使用者活動
3. WHEN 偵測到點擊事件 THEN 自動登出系統 SHALL 記錄為使用者活動
4. WHEN 偵測到觸控事件 THEN 自動登出系統 SHALL 記錄為使用者活動
5. WHEN 使用者切換瀏覽器分頁後返回 THEN 自動登出系統 SHALL 檢查總閒置時間並相應處理

### 需求 11

**使用者故事:** 作為系統管理員，我希望自動登出功能能與現有的認證系統整合，確保資料安全。

#### 驗收標準

1. WHEN 執行自動登出 THEN 自動登出系統 SHALL 清除本地儲存的認證資料
2. WHEN 執行自動登出 THEN 自動登出系統 SHALL 清除會話狀態
3. WHEN 執行自動登出 THEN 自動登出系統 SHALL 跳轉到登入頁面
4. WHEN 自動登出完成 THEN 自動登出系統 SHALL 顯示登出原因訊息
5. WHEN 使用者重新登入 THEN 自動登出系統 SHALL 重新開始監控

### 需求 12

**使用者故事:** 作為使用者，我希望自動登出功能的設定是可配置的，以適應不同的使用情境。

#### 驗收標準

1. WHEN 系統初始化 THEN 自動登出系統 SHALL 使用預設的20分鐘超時設定
2. WHEN 系統管理員修改超時設定 THEN 自動登出系統 SHALL 使用新的超時時間
3. WHERE 開發環境 THEN 自動登出系統 SHALL 允許停用自動登出功能
4. WHERE 生產環境 THEN 自動登出系統 SHALL 強制啟用自動登出功能

### 需求 13

**使用者故事:** 作為員工，我想要使用下拉選單選擇開始和結束時間，以便我可以更容易且準確地輸入時間

#### 驗收標準

1. WHEN 員工存取請假申請頁面的開始時間欄位 THEN 員工請假系統 SHALL 顯示包含24小時制時間選項的下拉選單
2. WHEN 員工存取請假申請頁面的結束時間欄位 THEN 員工請假系統 SHALL 顯示包含24小時制時間選項的下拉選單
3. WHEN 員工點選時間下拉選單 THEN 員工請假系統 SHALL 顯示從00:00到23:45的當日時間選項，以及從00:00(+1)到07:00(+1)的隔日時間選項，以15分鐘為間隔
4. WHEN 員工選擇時間選項 THEN 員工請假系統 SHALL 將選定的時間值設定到對應的表單欄位
5. WHEN 時間選項顯示 THEN 員工請假系統 SHALL 使用HH:MM格式顯示當日時間選項，使用HH:MM(+1)格式顯示隔日時間選項

### 需求 14

**使用者故事:** 作為管理者，我想要使用下拉選單編輯請假記錄的時間，以便我可以準確地修改時間資訊

#### 驗收標準

1. WHEN 管理者開啟請假記錄編輯對話框 THEN 員工請假系統 SHALL 在開始時間和結束時間欄位顯示下拉選單
2. WHEN 管理者查看時間下拉選單 THEN 員工請假系統 SHALL 預選當前記錄的時間值
3. WHEN 管理者修改時間選擇 THEN 員工請假系統 SHALL 即時更新表單資料並觸發驗證
4. WHEN 管理者儲存修改 THEN 員工請假系統 SHALL 使用選定的時間值更新請假記錄

### 需求 15

**使用者故事:** 作為系統，我需要提供一致的時間選項，以便確保資料品質和使用者體驗

#### 驗收標準

1. WHEN 系統產生時間選項列表 THEN 員工請假系統 SHALL 建立從00:00到23:45的當日時間選項，以及從00:00(+1)到07:00(+1)的隔日時間選項，每15分鐘間隔
2. WHEN 系統顯示時間選項 THEN 員工請假系統 SHALL 確保所有時間選項使用兩位數格式（例如：09:00而非9:00）
3. WHEN 系統處理時間選擇 THEN 員工請假系統 SHALL 驗證選定的時間值符合預定義的選項列表
4. WHEN 系統計算請假時數 THEN 員工請假系統 SHALL 使用選定的時間值進行準確的時數計算
5. WHEN 系統儲存時間資料 THEN 員工請假系統 SHALL 保持時間格式與現有CSV檔案結構相容

### 需求 16

**使用者故事:** 作為使用者，我想要時間選擇器具有良好的可用性，以便我可以快速找到和選擇所需的時間

#### 驗收標準

1. WHEN 使用者開啟時間下拉選單 THEN 員工請假系統 SHALL 顯示可滾動的選項列表且高度適中
2. WHEN 使用者滾動時間選項 THEN 員工請假系統 SHALL 提供流暢的滾動體驗
3. WHEN 使用者搜尋特定時間 THEN 員工請假系統 SHALL 支援鍵盤輸入快速定位到相近的時間選項
4. WHEN 時間選擇器獲得焦點 THEN 員工請假系統 SHALL 提供視覺回饋指示當前選中的選項
5. WHEN 使用者在行動裝置上操作 THEN 員工請假系統 SHALL 確保時間選擇器在觸控螢幕上易於使用

### 需求 17

**使用者故事:** 作為開發者，我想要時間選擇器組件可重複使用，以便在不同頁面保持一致性

#### 驗收標準

1. WHEN 開發者實作時間選擇器 THEN 員工請假系統 SHALL 建立可重複使用的TimeSelector組件
2. WHEN TimeSelector組件被使用 THEN 員工請假系統 SHALL 支援自訂屬性如預設值、禁用狀態和錯誤顯示
3. WHEN TimeSelector組件渲染 THEN 員工請假系統 SHALL 與現有的表單樣式和主題保持一致
4. WHEN TimeSelector組件更新 THEN 員工請假系統 SHALL 正確觸發onChange事件並傳遞選定的時間值
5. WHEN TimeSelector組件接收外部值變更 THEN 員工請假系統 SHALL 同步更新內部狀態和顯示

### 需求 18

**使用者故事:** 作為使用者，我想要簡化的時間選擇介面，以便更直觀地選擇跨日時間

#### 驗收標準

1. WHEN 系統實作新的時間選擇器 THEN 員工請假系統 SHALL 移除現有的"隔日"勾選欄位
2. WHEN 使用者需要選擇隔日時間 THEN 員工請假系統 SHALL 透過時間選項中的(+1)標記提供隔日時間選擇
3. WHEN 使用者選擇帶有(+1)標記的時間 THEN 員工請假系統 SHALL 自動識別為隔日時間並進行相應處理
4. WHEN 系統計算請假時數 THEN 員工請假系統 SHALL 計算結束時間減去開始時間的時間差，並扣除重疊的休息時間（12:00-12:30和16:30-17:00），扣除上限為0.5小時
5. WHEN 系統儲存請假記錄 THEN 員工請假系統 SHALL 將(+1)標記的時間轉換為適當的日期時間格式儲存
6. WHEN 使用者選擇開始時間和結束時間 THEN 員工請假系統 SHALL 驗證結束時間晚於開始時間，並在不符合時顯示錯誤訊息

### 需求 19

**使用者故事:** 作為使用者，我想要更合理的表單欄位順序，以便更順暢地填寫請假申請

#### 驗收標準

1. WHEN 使用者填寫請假申請表單 THEN 員工請假系統 SHALL 將"假別"欄位放置在"事由"欄位之前
2. WHEN 使用者查看表單 THEN 員工請假系統 SHALL 按照邏輯順序排列欄位：工號、姓名、假別、請假日期、開始時間、結束時間、請假時數、事由
3. WHEN 管理者編輯請假記錄 THEN 員工請假系統 SHALL 在編輯對話框中使用相同的欄位順序